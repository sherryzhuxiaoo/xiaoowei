<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cloud Collection</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://use.typekit.net/laf6orl.css" />
  </head>
  <body>
    <div class="container">
      <div class="grid" id="imageGrid"></div>
    </div>

    <script>
      const imageGrid = document.getElementById("imageGrid");
      const container = document.getElementById("container");

      // 自定义颜色数组
      const colors = [
        "#01B1EB",
        "#B9DDF7",
        "#026599",
        "#64BFEE",
        "#5490A8",
        "#024E85",
        "#E7F3FB",
        "#B8D4E9",
        "#E7F3FB",
        "#9FE2FF,",
      ]; // 蓝色系列

      // 文字随机背景
      const lettersBgColors = ["#FFFFFF", "#E7F3FB", "#00ACE9"];

      const lettersBackImg = {
        "2,1": "E.png",
        "2,2": "P.png",
        "3,1": "H.png",
        "3,2": "E.png",
        "3,3": "M.png",
        "3,4": "E.png",
        "4,3": "M.png",
        "4,4": "M.png",
      };

      // 图片数组
      const images = [
        {
          src: "cirro.jpg",
          text: "Title: Cirrostratus\nArtist: Sky\nPlace: New Jersey\nTime of Creation: 4:15 PM, August 23rd",
          link: "cirro.html", // 点击后跳转的链接
        },
        {
          src: "IMG_4577.JPG",
          text: "Title: Cirrus\nArtist: Sky\nPlace: New Jersey\nTime of Creation: 6:00 PM, August 21st",
          link: "cirrus.html",
        },
        {
          src: "IMG_4580.JPG",
          text: "Title: Cirrus\nArtist: Sky\nPlace: New Jersey\nTime of Creation: 3:00 PM, August 28th",
          link: "cirrus.html",
        },
        {
          src: "IMG_4585.JPG",
          text: "Title: Cirrostratus\nArtist: Sky\nPlace: New Jersey\nTime of Creation: 6:04 PM, January 16th",
          link: "cirro.html",
        },
        {
          src: "IMG_4594.JPG",
          text: "Title: Altocumulus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: \n17:48 PM, \nMay 19th",
          link: "altocu.html",
        },
        {
          src: "IMG_4601.JPG",
          text: "Title: Altocumulus\nArtist: Sky\nPlace: New Jersey\nTime of Creation: 2:00 PM, \nAugust 23rd",
          link: "altocu.html",
        },
        {
          src: "IMG_4650.JPG",
          text: "Title: Cirrocumulus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 4:00 PM, January 4th",
          link: "cirro.html",
        },
        {
          src: "IMG_4687.JPG",
          text: "Title: Altostratus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 12:50 PM, August 28th",
          link: "altostra.html",
        },
        {
          src: "IMG_4691.JPG",
          text: "Title: Stratus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 16:50 PM, January 14th",
          link: "stratu.html",
        },
        {
          src: "IMG_4694.JPG",
          text: "Title: Cumulus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 15:48 PM, May 20th",
          link: "cumu.html",
        },
        {
          src: "IMG_4709.JPG",
          text: "Title: Stratocumulus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 14:49 PM, January 11th",
          link: "strato.html",
        },
        {
          src: "IMG_4710.JPG",
          text: "Title: Stratocumulus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 18:37 PM, September 3rd",
          link: "strato.html",
        },
        {
          src: "IMG_4711.PNG",
          text: "Title: Cirrocumulus\nArtist: Sky\nPlace: New Jersey\nTime of Creation: 2:15 PM, August 13rd",
          link: "cirro.html",
        },
        {
          src: "cover.PNG",
          text: "Title: Stratocumulus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 15:30 PM, August 28th",
          link: "strato.html",
        },
        {
          src: "new1.PNG",
          text: "Title: Cirrostratus\nArtist: Sky\nPlace: New Jersey \nTime of Creation: 11:03 PM, August 29th",
          link: "cirro.html",
        },
      ]; // 添加你的图片链接和描述

      // 生成随机颜色的长方形
      function getRandomColor(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      // 生成图片网格，确保图片足够多以覆盖屏幕并可以滚动
      function generateGrid() {
        const contentW = Math.ceil(window.innerWidth / 6);
        const contentH = Math.ceil(window.innerHeight / 6);

        let rows = 6;
        let cols = 6;

        /*
            固定字母的位置，固定在中间 ，生成坐标范围
        */
        const letterX = [rows / 2 - 1, rows / 2 + 2 - 1];
        const letterY = [cols / 2 - 1 - 1, cols / 2 - 1 - 1 + 3];

        console.log(letterX, letterY);

        // 清空现有内容
        imageGrid.innerHTML = "";

        let lbgc = getRandomColor(lettersBgColors);

        // 添加图片和随机长方形到网格中
        for (let r = 0; r < rows; r++) {
          for (let c = 0; c < cols; c++) {
            let drawLetter = false;
            // 如果当前rc在字母位置范围内
            if (
              r >= letterX[0] &&
              r <= letterX[1] &&
              c >= letterY[0] &&
              c <= letterY[1]
            ) {
              drawLetter = true;
              // 第一行字母只显示在前半，最后一行字母只显示在后半
              if (r === letterX[0] && c > letterY[1] - 2) {
                drawLetter = false;
              }
              if (r === letterX[1] && c <= letterY[1] - 2) {
                drawLetter = false;
              }
            }
            const randomChoice = Math.random();
            if (drawLetter || randomChoice < 0.5) {
              const flipContainer = document.createElement("div");
              flipContainer.className = "flip-container";

              const flipCard = document.createElement("div");
              flipCard.className = "flip-card";

              // 正面
              const front = document.createElement("div");
              front.className = "flip-card-front";

              let randomIndex = null;

              if (drawLetter) {
                const letterDom = document.createElement("div");
                letterDom.className = "letter";
                letterDom.style.backgroundColor = getRandomColor(colors); // 颜色 lbgc

                front.appendChild(letterDom);
                flipCard.appendChild(front);

                // 背面字母图片
                const back = document.createElement("div");
                back.className = "flip-card-back";
                const backImg = document.createElement("img");
                backImg.src = lettersBackImg[`${r},${c}`];
                backImg.alt = "image";
                backImg.className = "flip-card-back-img";
                back.appendChild(backImg);
                flipCard.appendChild(back);
              } else {
                const img = document.createElement("img");
                randomIndex = Math.floor(Math.random() * images.length); // 随机选择图片
                img.src = images[randomIndex].src; // 使用随机选择的图片
                img.alt = "image";

                front.appendChild(img);
                flipCard.appendChild(front);

                // 背面文字
                const back = document.createElement("div");
                back.className = "flip-card-back";
                back.innerText = images[randomIndex].text; // 使用对应的文字
                flipCard.appendChild(back);
              }

              flipContainer.appendChild(flipCard);
              imageGrid.appendChild(flipContainer);

              // 事件处理
              let timeout;
              flipContainer.onmouseenter = () => {
                timeout = setTimeout(() => {
                  flipCard.style.transform = "rotateY(180deg)"; // 翻转
                }, 600); // 2秒后翻转
              };

              flipContainer.onmouseleave = () => {
                clearTimeout(timeout);
                flipCard.style.transform = "rotateY(0deg)"; // 还原
              };

              if (randomIndex) {
                flipContainer.onclick = () => {
                  window.location.href = images[randomIndex].link; // 点击后跳转
                };
              }
            } else {
              const rectangle = document.createElement("div");
              rectangle.className = "rectangle";
              rectangle.style.left = `${c * contentW}px`;
              rectangle.style.top = `${r * contentH}px`;
              rectangle.style.backgroundColor = getRandomColor(colors); // 随机颜色
              imageGrid.appendChild(rectangle);
            }
          }
        }

        // 设置grid容器的宽度和高度，确保它包含所有内容
        imageGrid.style.width = `${cols * contentW}px`;
        imageGrid.style.height = `${rows * contentH}px`;
      }

      // 初始化：生成内容
      generateGrid();

      // 防抖
      function debounce(func, delay) {
        let timer;
        return function () {
          clearTimeout(timer);
          timer = setTimeout(func, delay);
        };
      }

      const debounceGenerateGrid = debounce(generateGrid, 200);

      // 视口改变时重新生成内容
      // window.onresize = generateGrid;
      window.onresize = debounceGenerateGrid;
    </script>
  </body>
</html>
